(function($){$.fn.GetTextRemainsElement=function(){var input=$(this),remains=null,id=input.attr("id");if(id!=undefined&&id!=null&&id.length>0)remains=$("#"+id+"_remains");return remains};$.fn.SetTextRemainContent=function(){var input=$(this),maxLen=parseInt(input.attr("maxlength"),10),value=input.val(),curLen=value.length;if(curLen>maxLen){value=$.trim(value);curLen=value.length;if(curLen>maxLen){value=value.substring(0,maxLen);input.val(value);curLen=maxLen}}var remains=input.GetTextRemainsElement(),remainFormat=remains.attr("format"),len=(maxLen-curLen).toString();if(remainFormat.length>0)remains.text(remainFormat.replace("{0}",len));else remains.text(len);return input};$.fn.SetInputTextLength=function(){var input=$(this),maxLen=input.attr("maxlength");if(!maxLen)return input;maxLen=parseInt(maxLen,10);if(maxLen<1)return input;var remains=input.GetTextRemainsElement();if(remains==null||remains.length<1)return input;var func=function(){input.SetTextRemainContent()};input.keyup(func);input.mouseup(func);return input};$.fn.ellipsis=function(){return this.each(function(){var el=$(this);if(el.css("overflow")=="hidden"){var shrunk=false,title=el.text();if(title.length>0){var toclean=el.html(),ellipsisvert=el.hasClass("ellipsisvert"),dup=$(this.cloneNode(true)).hide().css("position","absolute").css("overflow","visible").width(ellipsisvert?el.width():"auto").height(ellipsisvert?"auto":el.height()),height=function(){return dup.height()>el.height()},width=function(){return dup.width()>el.width()},func=ellipsisvert?height:width;el.after(dup);while(toclean.length>0&&func()){shrunk=true;toclean=toclean.substr(0,toclean.length-1);dup.html(toclean+"...")}if(shrunk){el.html(dup.html());if(title.length>0)el.attr("title",jQuery.trim(title))}dup.remove()}}})};$.fn.getFocusable=function(){var that=this;return that.find("[tabindex]").not("[tabindex='-1']").add(that.find("a, button, input, select, textarea, iframe").not("input[type='hidden']"))};$.fn.isHorizonOverflow=function(){var that=this;return that.get(0).clientWidth<that.get(0).scrollWidth}})(jQuery);if(typeof Answers==="undefined")var Answers={};Answers.Util={ConfirmDialogType:{SubmitCancel:0,YesNo:1,OkCancel:2},ReadOnlyErrorHandled:false,ScrollToTop:function(){$(document).scrollTop(0)},NavigateTo:function(url,params){if(!url)return;if(params)url=url+"?"+$.param(params);window.location.href=url},CompareStringsLocale:function(str1,str2,locale){try{return str1.localeCompare(str2,locale)}catch(e){return CompareStrings(str1,str2)}},CompareStrings:function(str1,str2){if(typeof str1=="string"&&typeof str2=="string")if(str1>str2)return 1;else if(str1<str2)return -1;else return 0;else throw"Objects are not strings"},IsSiteReadOnly:function(){if(window.isSiteReadOnly)return window.isSiteReadOnly;return false},GetBaseUrl:function(){return window.location.origin},ReplaceUrlParam:function(url,paramName,paramValue){if(!url||!paramName)return url;var currentValue=Answers.Util.GetUrlParameterValue(url,paramName);if(!currentValue&&paramValue==="")return url;if(currentValue&&currentValue.toLowerCase()===paramValue.toLowerCase())return url;var pattern=new RegExp("("+paramName+"=).*?(&|$)"),newUrl=url.replace(pattern,"$1"+paramValue+"$2");if(newUrl==url)newUrl=newUrl+(newUrl.indexOf("?")>0?"&":"?")+paramName+"="+paramValue;return newUrl},GetUrlParameterValue:function(url,paramName){var urlParameters=url.split("?")[1];if(urlParameters){var queryParams=urlParameters.split("&");for(var i=0;i<queryParams.length;i++){var queryParam=queryParams[i].split("=");if(queryParam[0]==paramName)return queryParam[1]}}},InitiateDialogs:function(dialog){dialog=dialog instanceof jQuery?dialog:$(".dialogPanel");dialog.appendTo("#Footer");dialog.on("keydown.dialogs",function(event){if(event.which===27)Answers.Util.HideDialog($(this))});$('<div class="grayBox"></div>').appendTo("#Footer");Answers.Util.DialogClose(dialog)},ShowDialog:function(jElem,data,callback){var d={url:null,refresh:false,data:null,focusBack:null},focusableElements;$.extend(d,data);if(jElem.length===0&&d.url&&typeof d.url==="string"||d.refresh===true){Answers.Util.GetDialog(jElem,d,callback);return}focusableElements=$(document).getFocusable();focusableElements.filter("[tabindex]").each(function(){var that=$(this);that.data("reserved-tabindex",that.attr("tabindex"))});focusableElements.attr("tabindex",-1);jElem.css({top:Math.max(0,($(window).height()-jElem.outerHeight())/2+$(window).scrollTop())+"px",left:Math.max(0,($(window).width()-jElem.outerWidth())/2+$(window).scrollLeft())+"px"});if(!d.appendToBody)jElem.appendTo("body");jElem.show().getFocusable().removeAttr("tabindex").eq(1).focus();jElem.data("focusBack",d.focusBack);$("body").addClass("footerTop");$(".grayBox").appendTo("body").show();if(callback&&typeof callback==="function")callback()},GetDialog:function(jElem,data,callback){$.get(data.url,data.data,function(output){jElem.remove();$("body").append(output);data.appendToBody=true;data.refresh=false;Answers.Util.ShowDialog($(jElem.selector),data,callback);Answers.Util.DialogClose($(jElem.selector))},"html")},ShowWarningDialog:function(jElem,warningId,warningMsg){warningId.html(warningMsg);Answers.Util.ShowDialog(jElem)},DialogClose:function(container){$(".dlgCloseBtn",container).on("click",function(event){if($(this).hasClass("disabled"))return;Answers.Util.HideDialog($(this).closest(".dialogPanel"));event.stopPropagation()})},ShowSimpleDialog:function(title,content){var dlg=$("#SimpleMsgDialog");$(".dialogTitleText",dlg).text(title);$("#SimpleMsgDialogContent").text(content);Answers.Util.ShowDialog(dlg)},ShowSimpleConfirm:function(title,content,callback,dialogType){if(dialogType!==undefined)if(dialogType===Answers.Util.ConfirmDialogType.YesNo){$("#confirmSubmitBtn").text(Answers.Res.Yes).prop("title",Answers.Res.Yes);$("#confirmCancelBtn").text(Answers.Res.No).prop("title",Answers.Res.No)}else if(dialogType===Answers.Util.ConfirmDialogType.OkCancel){$("#confirmSubmitBtn").text(Answers.Res.Ok).prop("title",Answers.Res.Ok);$("#confirmCancelBtn").text(Answers.Res.Cancel).prop("title",Answers.Res.Cancel)}var dlg=$("#SimpleConfirmDialog");$(".dialogTitleText").text(title);$("#SimpleConfirmDialogContent").text(content);Answers.Util.ShowDialog(dlg,[],callback)},ShowSimpleDialogConfirm:function(callback,dialogType){if(dialogType!==undefined)if(dialogType===Answers.Util.ConfirmDialogType.YesNo){$("#confirmSubmitBtn").text(Answers.Res.Yes).prop("title",Answers.Res.Yes);$("#confirmCancelBtn").text(Answers.Res.No).prop("title",Answers.Res.No)}else if(dialogType===Answers.Util.ConfirmDialogType.OkCancel){$("#confirmSubmitBtn").text(Answers.Res.Ok).prop("title",Answers.Res.Ok);$("#confirmCancelBtn").text(Answers.Res.Cancel).prop("title",Answers.Res.Cancel)}var dlg=$("#SimpleDialog");Answers.Util.ShowDialog(dlg,[],callback)},ShowSimpleAcceptDialog:function(title,content,htmlControl,callback){var dlg=$("#SimpleAcceptDialog");$(".dialogTitleText").text(title);$("#SimpleAcceptDialogContent").text(content);$("#SimpleActionOptionsSection").html(htmlControl);$("#dialogWait").hide();Answers.Util.ShowDialog(dlg,[],callback)},ShowSimpleCompleteDialog:function(title,content,callback){var dlg=$("#simpleCompleteDialog");$(".dialogTitleText").text(title);$("#simpleCompleteDialogContent").text(content);Answers.Util.ShowDialog(dlg,[],callback)},HideDialog:function(jElem,focusOn){if($(".dialogPanel:visible").length<=1){$("body").removeClass("footerTop");Answers.Util.HideGrayBox();$(document).getFocusable().each(function(){var that=$(this);if(that.data("reserved-tabindex"))that.attr("tabindex",that.data("reserved-tabindex"));else that.removeAttr("tabindex")})}else $(".dialogPanel:visible").getFocusable().removeAttr("tabindex");setTimeout(function(){if(focusOn&&focusOn.length>0)focusOn.focus();else if(jElem.data("focusBack")!=null)$(jElem.data("focusBack")).focus()});jElem.trigger("closing");return jElem.appendTo("#Footer").hide()},HideGrayBox:function(){$(".grayBox").appendTo("#Footer").hide()},IsDialogOpenning:function(selector){return $(selector+":visible").hasClass("dialogPanel")},HandleActionsForDropdown:function(e,handler,parameters){switch(e.which){case 1:case 13:case 32:case 40:handler(parameters)}},ReloadPage:function(targetUrl){if(arguments.length==0||targetUrl==null){targetUrl=window.location.pathname;if(window.location.search.length>1)targetUrl+=window.location.search}var newUrl=Answers.Util.AddParamValue(targetUrl,"tm",(new Date).getTime());if(typeof DataCollectionObj!=="undefined"&&DataCollectionObj&&DataCollectionObj.options)DataCollectionObj.options.targetUrl=newUrl;window.location=newUrl},ValidateTextarea:function(elemId,minLen,maxLen,errorMsg,errorMsgElemId){var textContent=Answers.Res.TelerikEditor.Editor==="telerik"?Answers.Editor.Text(elemId):$.trim($("#"+elemId).RichTextEditorText()),htmlContent=Answers.Res.TelerikEditor.Editor==="telerik"?Answers.Editor.Content(elemId):$.trim($("#"+elemId).RichTextEditorContent());if(textContent.length<minLen||htmlContent.length<minLen||textContent.length>maxLen||htmlContent.length>maxLen){var maxChars=textContent.length>maxLen||htmlContent.length>maxLen?Math.max(textContent.length,htmlContent.length):Math.min(textContent.length,htmlContent.length),errMsg=errorMsg.replace("{0}",maxChars);$("#"+errorMsgElemId).text(errMsg).show();return false}return true},ValidateTextbox:function(elemId,minLen,maxLen,errorMsgElemId){var elem=$("#"+elemId),elemContainer=elem;if(elem.attr("type")!="text")elemContainer=elem.parent();elemContainer.removeClass("errorValidation");var elemErrMsg=$("#"+errorMsgElemId);elemErrMsg.hide();var txt=$.trim(elem.val());if(txt.length<minLen||txt.length>maxLen){elemContainer.addClass("errorValidation");elemErrMsg.show();return false}return true},ValidateTextboxRegEx:function(elemId,pattern,errorMsgElemId){var elem=$("#"+elemId),elemContainer=elem;if(elem.attr("type")!="text")elemContainer=elem.parent();elemContainer.removeClass("errorValidation");var elemErrMsg=$("#"+errorMsgElemId);elemErrMsg.hide();var txt=$.trim(elem.val()),regEx=new RegExp(pattern);if(!regEx.test(txt)){elemContainer.addClass("errorValidation");elemErrMsg.css("display","inline");return false}return true},ValidateGUID:function(input){var guidFormat=/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/;return guidFormat.test(input)},ValidateSelectVal:function(elemId,invalidVal,errorMsgElemId){var elem=$("#"+elemId),elemContainer=elem.parent(),elemErrMsg=null,txt=$.trim(elem.val());if(typeof errorMsgElemId!=="undefined")elemErrMsg=$("#"+errorMsgElemId);if(txt==invalidVal){elemContainer.addClass("errorValidation");if(elemErrMsg!=null)elemErrMsg.show();return false}elemContainer.removeClass("errorValidation");if(elemErrMsg!=null)elemErrMsg.hide();return true},GetCookie:function(key,subkey){if(!key)return;var cn,cv,ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){cn=ca[i].substring(0,ca[i].indexOf("="));if(cn.charAt(0)==" ")cn=cn.substring(1,cn.length);if(key===cn){cv=ca[i].substring(ca[i].indexOf("=")+1,ca[i].length);break}}if(!cv)return "";if(!subkey)return cv;ca=cv.split("&");for(i=0;i<ca.length;i++){cn=ca[i].substring(0,ca[i].indexOf("="));if(cn.charAt(0)==" ")cn=cn.substring(1,cn.length);if(subkey===cn)return ca[i].substring(ca[i].indexOf("=")+1,ca[i].length)}},SetCookie:function(key,val,subkey,persist,domain){this.SetCookieWithExpiration(key,val,subkey,persist?525600:null,domain)},SetCookieWithExpiration:function(key,val,subkey,expires,domain){if(!key)return;var cv="",cs="",cd="",d=new Date,e;if(expires){expires=expires*60000;e=new Date(d.getTime()+expires);cs="; expires="+e.toUTCString()}if(domain)cd="; domain="+domain;cv=this.GetCookie(key);if(cv&&subkey){var cn,subkeyfound=false;if(cv.indexOf("=")>-1){var ca=cv.split("&");for(var i=0;i<ca.length;i++){cn=ca[i].substring(0,ca[i].indexOf("="));if(cn.charAt(0)==" ")cn=cn.substring(1,cn.length);if(subkey===cn){ca[i]=subkey+"="+val;cv=ca.join("&");subkeyfound=true;break}}if(!subkeyfound){if(ca.length>0)cv+="&";cv+=subkey+"="+val}}else cv=subkey+"="+val}else if(!cv&&subkey)cv=subkey+"="+val;else if(!subkey)cv=val;else return;document.cookie=key+"="+cv+cs+cd+"; path=/"},SetCookieWithMaxEntries:function(key,val,subkey,maxItems,persist){var oldCookie=Answers.Util.GetCookie(key),newCookieValue=subkey+"="+val;if(oldCookie.length>0){var oldItems=oldCookie.split("&"),newItems=[];newItems.push(subkey+"="+val);for(i=0;i<oldItems.length;i++){var sk=$.trim(oldItems[i].substring(0,oldItems[i].indexOf("=")));if(sk!=subkey)newItems.push(oldItems[i]);if(newItems.length>=maxItems)break}newCookieValue=newItems.join("&")}Answers.Util.SetCookie(key,newCookieValue,null,persist)},ExpireCookie:function(key,domain){if(!key)return;var cv="",cd="",d=new Date,cs="; expires="+d.toGMTString(d.setFullYear(d.getFullYear()-1));if(domain)cd="; domain="+domain;document.cookie=key+"="+cv+cs+cd+"; path=/"},QueryStringTable:null,QueryString:function(qsKey){qsKey=qsKey.toLowerCase();if(Answers.Util.QueryStringTable!=null)return Answers.Util.QueryStringTable[qsKey];var qs=document.location.search.toString();if(qs.length>0)qs=qs.substring(1);Answers.Util.QueryStringTable={};var pairs=qs.split("&"),key,value;for(var i=0;i<pairs.length;i++){var pair=pairs[i].split("=");if(pair.length!=2||pair[1]=="")continue;try{key=decodeURI(pair[0]).toLowerCase();value=decodeURI(pair[1])}catch(e){key=unescape(pair[0]).toLowerCase();value=unescape(pair[1])}if(Answers.Util.QueryStringTable[key])Answers.Util.QueryStringTable[key]+=", "+value;else Answers.Util.QueryStringTable[key]=value}return Answers.Util.QueryStringTable[qsKey]},SetTimeZoneOffset:function(){var tzOffset=null,tzOffsetStr=Answers.Util.GetCookie("tzo");if(tzOffsetStr!=null)tzOffset=parseInt(tzOffsetStr);var offset=(new Date).getTimezoneOffset();if(tzOffset==null||isNaN(tzOffset)||tzOffset!=offset)Answers.Util.SetCookie("tzo",offset,null,true)},ValidatePageOnlyNumbers:function(elem,containerElem){containerElem=typeof containerElem==="undefined"?"":containerElem+" ";$(containerElem+"#pageError").children().hide();if(elem.value.match(/[^0-9]/)){$(containerElem+"#pageErrorOnlyNumbers").show();elem.value=elem.value.replace(/[^0-9]/g,"")}if(elem.value.length>4){$(containerElem+"#pageErrorLower").show();elem.value=elem.value.substring(0,4)}},ValidatePageValue:function(e,newPage,currentPage,maxPage,containerElem){if(e.keyCode==13){currentPage=parseInt(currentPage,10);maxPage=parseInt(maxPage,10);newPage=parseInt(newPage,10);containerElem=typeof containerElem==="undefined"?"":containerElem+" ";$(containerElem+"#pageError").children().hide();if(newPage==currentPage||newPage<0)$(containerElem+"#pageErrorNotAvailable").show();else if(newPage>maxPage&&maxPage>0)$(containerElem+"#pageErrorLower").show();else return newPage}return 0},Obfuscate:function(target){return target.replace(/\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/gi,Answers.Res.Obfuscate.ObfuscateMailContent)},PadZeros:function(num,size){var s=num+"";while(s.length<size)s="0"+s;return s},SetEventLogging:function(bitPosition){try{if(bitPosition&&(bitPosition>=0&&bitPosition<=59))DataCollectionObj.options.eventCollectionId|=1<<bitPosition}catch(e){}},AddParamValue:function(url,paramName,paramValue){if(url.indexOf(paramName+"=")>0){var regex=new RegExp(paramName+"=\\w+","i");url=url.replace(regex,paramName+"="+paramValue)}else{var hash="",hashStart=url.indexOf("#");if(hashStart>=0){hash=url.substr(hashStart);url=url.substr(0,hashStart)}var paramStart=url.indexOf("?")>=0?"&":"?";url+=paramStart+paramName+"="+paramValue+hash}return url},CallScript:function(getScript,url,callback){callback=typeof callback==="function"?callback:function(){};getScript?$.ajax({cache:true,dataType:"script",url:url}).always(callback):callback()},IsElementInView:function(e){var scrollTop=document.documentElement.scrollTop||document.body.scrollTop,eTop=$(e).offset().top,eHeight=$(e).height(),winHeight=window.innerHeight&&window.innerHeight<$(window).height()?window.innerHeight:$(window).height();return eTop>scrollTop&&eHeight+eTop<scrollTop+winHeight},Increment:function(jElem,val){if(jElem.length<=0)return;var num=parseInt($(jElem[0]).text()),newNum=isNaN(num)?val:num+val;jElem.text(newNum>0?newNum:"");return newNum},DisableReadOnlyClick:function(){$(".disabled").on("click",function(){return false})},HandleReadOnlyResponse:function(responseText){if(Answers.Util.ReadOnlyErrorHandled){Answers.Util.ReadOnlyErrorHandled=false;return}if(!responseText)return;var response=$.parseJSON(responseText);if(response&&response.Reason&&response.Reason==="ReadOnly"){$("#readOnlyError .dialogBox .dialogTitle .dialogTitleText").text(response.Title);$("#readOnlyErrorMessage").html(response.Message);Answers.Util.ShowDialog($("#readOnlyError"));$("#readOnlyWarningOK").off();$("#readOnlyWarningOK").on("click",function(){Answers.Util.HideDialog($(this).closest(".dialogPanel"))})}},HandleReadOnlyResponseSilently:function(xhr){if(!xhr)return;var response=$.parseJSON(xhr.responseText);if(response&&response.Reason&&response.Reason==="ReadOnly")Answers.Util.ReadOnlyErrorHandled=true},FindElementPostion:function(elem){var top=0,left=0;if(elem.offsetParent)do{top+=elem.offsetTop;left+=elem.offsetLeft;elem=elem.offsetParent}while(elem!=undefined);return {Top:top,Left:left}},TruncateText:function(text,maxLength,showEllipsis){text=$.trim(text);if(text.length>maxLength){var words=text.substring(0,maxLength+1).split(" "),shortText=words.slice(0,-1).join(" ");if(showEllipsis)shortText+="...";return shortText}return text}};Answers.User={GetUserByDisplayName:function(displayName,handleResult){$.getJSON(Answers.Res.GetUserByDisplayNameUrl,{displayName:displayName,antiForgeryKey:$("#_AntiForgeryKey").val()},function(result){handleResult(result)})}};Answers.Auth={SignedIn:function(){return $("#SignedIn").val()==="true"},SignInThen:function(nextAction,actionItemId,subActionId,subActionId2){if(Answers.Auth.SignedIn()===true)Answers.Auth.PerformNextAction(nextAction,actionItemId,subActionId,subActionId2);else{var rtPageUrl=window.location.href;if(nextAction!=null){var cookieName="rtAction",timestamp=(new Date).getTime();Answers.Util.SetCookie(cookieName,timestamp,"timestamp",false);Answers.Util.SetCookie(cookieName,nextAction,"nextAction",false);Answers.Util.SetCookie(cookieName,actionItemId,"actionItemId",false);Answers.Util.SetCookie(cookieName,subActionId,"subActionId",false);Answers.Util.SetCookie(cookieName,subActionId,"subActionId2",false);rtPageUrl=Answers.Util.AddParamValue(rtPageUrl,"rtAction",timestamp)}Answers.Util.SetCookie("rtPage",rtPageUrl,null,false);window.location.href=Answers.Res.SignInUrl}},CheckNextAction:function(){if(Answers.Auth.SignedIn()!==true)return;var rtTimestamp=Answers.Util.QueryString("rtAction");if(rtTimestamp!=null){var cookieName="rtAction",cookieTimestamp=Answers.Util.GetCookie(cookieName,"timestamp");if(cookieTimestamp==rtTimestamp){var nextAction=Answers.Util.GetCookie(cookieName,"nextAction"),actionItemId=Answers.Util.GetCookie(cookieName,"actionItemId"),subActionId=Answers.Util.GetCookie(cookieName,"subActionId"),subActionId2=Answers.Util.GetCookie(cookieName,"subActionId2");Answers.Util.ExpireCookie(cookieName);Answers.Auth.PerformNextAction(nextAction,actionItemId,subActionId,subActionId2)}}},PerformNextAction:function(nextAction,actionItemId,subActionId,subActionId2){if(nextAction!=null)switch(nextAction){case "Join":Answers.Thread.JoinAfterSignIn(actionItemId);break;case "Recommend":Answers.Thread.RecommendAfterSignIn(actionItemId);break;case "BlogPost.Recommend":Answers.BlogPost.RecommendAfterSignIn(actionItemId);break;case "BlogPost.Subscribe":Answers.BlogPost.SubscribeAfterSignIn(actionItemId);break;case "BlogPost.Unsubscribe":Answers.BlogPost.UnsubscribeAfterSignIn(actionItemId);break;case "BlogPost.Comment":Answers.BlogPost.CommentAfterSignIn(actionItemId,subActionId);break;case "BlogPost.CommentHelpful":Answers.BlogPost.CommentHelpfulAfterSignIn(actionItemId);break;case "Blog.Subscribe":Answers.ViewBlog.SubscribeAfterSignIn(actionItemId);break;case "Blog.Unsubscribe":Answers.ViewBlog.UnsubscribeAfterSignIn(actionItemId);break;case "BlogPostAbuse":Answers.BlogPost.ViewAbuseMenu(null,null,actionItemId,subActionId);break;case "BlogPost.EditAbuse":Answers.BlogPost.EditBlogPostAbuseAfterSignIn(actionItemId,subActionId,subActionId2);break;case "BlogPost.EditCommentAbuse":Answers.BlogPost.EditBlogPostCommentAbuseAfterSignIn(actionItemId,subActionId,subActionId2);break;case "Vote":Answers.Thread.VoteAfterSignIn(actionItemId);break;case "Reply":Answers.Thread.ReplyAfterSignIn(actionItemId,subActionId);break;case "ThreadAbuse":Answers.Thread.ViewAbuseMenu(null,null,actionItemId,subActionId);break;case "ProfileAbuse":Answers.UserProfile.ViewAbuseMenu(null,null,actionItemId,subActionId);break;case "AskAQuestion":Answers.SearchResults.AskAQuestionAfterSignIn();break;case "SubscribeThread":Answers.Thread.SubscribeThreadAfterSignIn(actionItemId);break;case "WikiHelpful":Answers.Wiki.WikiHelpfulAfterSignIn(actionItemId);break;case "Comment":Answers.Wiki.CommentAfterSignIn(actionItemId,subActionId);break;case "CommentHelpful":Answers.Wiki.CommentHelpfulAfterSignIn(actionItemId);break;case "SubscribeWiki":Answers.Wiki.SubscribeWikiAfterSignIn(actionItemId);break;case "CommentAbuse":Answers.Wiki.CommentAbuseMenu(null,null,actionItemId,subActionId);break}},VerifyEmail:function(callback){$.post(Answers.Res.CheckEmailUrl,{antiForgeryKey:$("#_AntiForgeryKey").val()},function(result){if(result=="0"){if(callback!=null)callback(false);return}if(result=="1"||result=="2"){if(callback!=null)callback(true);return}var dlg=$("#updateEmailDlg");if(dlg.length==0){$(document.body).append('<div class="dialogPanel" id="updateEmailDlg"><div class="dialogBox"><div class="dialogBody">'+'<iframe id="updateEmailFr" scrolling="no" frameborder="0"></iframe>'+"</div></div></div>");dlg=$("#updateEmailDlg");$("#updateEmailFr").on("load",function(){try{$(this).height($(this).contents().find(".dialogBox").outerHeight(true));$(this).width($(this).contents().find(".dialogBox").outerWidth(true))}catch(e){}})}$("#updateEmailFr",dlg).attr("src",Answers.Res.UpdateEmailUrl);window.onUpdateEmailClose=function(done){window.onUpdateEmailClose=null;Answers.Util.HideDialog(dlg);if(callback!=null)callback(done)};Answers.Util.ShowDialog(dlg)},"json")},VerifySignIn:function(callback){$.post(Answers.Res.AuthStateUrl,null,function(result){if(callback!=null&&result!=null)callback(result)},"json")}};Answers.Announcement={Initilize:function(){$(".announcement").removeAttr("style");var button=$("#ShowAnnouncement");if(button.attr("data-opennow")==="true")Answers.DropNav.ShowNav($("#Announcements"));var setAnnCookie=function(){Answers.Util.SetCookie(Answers.Res.Announcement.CookieName,$("#Announcements").hasClass("dropNavShow")?"1":"0")};button.on("click.announce",function(event){setAnnCookie()});$("#Announcements").on("dropNavVisible",function(event){setAnnCookie()});$("#Announcements").on("dropNavHidden",function(event){setAnnCookie()})}};Answers.Search=function(){if($("#SearchBox").length>0){$("#SearchTerm").on({"focus.search":function(){$("#SearchForm").addClass("inputHasFocus");if(!$("#SearchScoping").hasClass("dropNavShow")){Answers.DropNav.ShowNav($("#SearchScoping"),false);setTimeout(function(){$("#SearchTerm").focus()},10);return true}},"blur.search":function(){$("#SearchForm").removeClass("inputHasFocus")},"keypress.search":function(event){if(!$("#SearchScoping").hasClass("dropNavShow")){Answers.DropNav.ShowNav($("#SearchScoping"),false);return true}},"keydown.search":function(event){Answers.DropNav.HandleSearchCommands(event);return true}});$(".forumSelect").on("click.search",function(event){$("#CurrentScope_ForumName").val($(this).attr("data-forum"));$("#CurrentScope_Filter").val($(this).attr("data-filter"));var input=$.trim($("#SearchTerm").val());if(input.length>0)$("#SearchTerm").closest("form").submit();else{$("#dropNavSearch").find(".forumSelect").removeClass("dropNavSelected");$(this).addClass("dropNavSelected");$("#SearchTerm").focus()}});$("#SearchForm").on("submit.search",function(){if(jQuery.trim($("#SearchTerm").val()).length>0){Answers.DropNav.HideNav($(this));return true}$("#SearchTerm").focus();return false});$("#Questions, #Discussions, #Wikis, #BlogPosts").on("click.search",function(){var contentTypeScope=[];if($("#Questions").is(":checked"))contentTypeScope.push("QnA");if($("#Discussions").is(":checked"))contentTypeScope.push("Discussion");if($("#Wikis").is(":checked"))contentTypeScope.push("Wiki");if($("#BlogPosts").is(":checked"))contentTypeScope.push("BlogPost");$("#ContentTypeScope").val(contentTypeScope.toString());$("#SearchForm").submit()})}};Answers.Editor=function(editor){editor.IsCustomCssLoaded=false;editor.Create=function(id,content,focusOnInit,onFocusCallback){if(!id)return;if(!$("link[href='"+Answers.Res.TelerikEditor.StyleSheetCommon+"']").length)$("<link href='"+Answers.Res.TelerikEditor.StyleSheetCommon+"' rel='stylesheet'>").appendTo("head");if(!$("link[href='"+Answers.Res.TelerikEditor.StyleSheetDefault+"']").length)$("<link href='"+Answers.Res.TelerikEditor.StyleSheetDefault+"' rel='stylesheet'>").appendTo("head");if(!$("link[href='"+Answers.Res.TelerikEditor.StyleSheetCustom+"']").length)$("<link href='"+Answers.Res.TelerikEditor.StyleSheetCustom+"' rel='stylesheet'>").appendTo("head");else editor.IsCustomCssLoaded=true;if(!$("link[href='"+Answers.Res.TelerikEditor.StyleSheetRtl+"']").length&&Answers.IsRtl)$("<link href='"+Answers.Res.TelerikEditor.StyleSheetRtl+"' rel='stylesheet'>").appendTo("head");editor.Remove(id);content=content===undefined||content===null?content||$("#"+id).text()||"":content;$("#"+id).text("");kendo.ui.editor.ColorTool.prototype.options.palette=["000000","005b6a","856200","d73900","2a00aa","a11d7a"];var toolbarFeature=$("#"+id).data("toolbar").split("|"),foreColor=$.inArray("nocolor",toolbarFeature)<0?"foreColor":"",insertImage="";if($.inArray("noimage",toolbarFeature)<0)insertImage={name:"insert-cps-image",tooltip:Answers.Res.TelerikEditor.InsertImage,exec:function(e){editor.ShowImage(id)}};$("#"+id).kendoEditor({value:content,stylesheets:[Answers.Res.TelerikEditor.Stylesheet],tools:[{name:"undotool",tooltip:Answers.Res.TelerikEditor.Undo,exec:function(e){var ed=$(this).data("kendoEditor");ed.exec("undo")}},{name:"redotool",tooltip:Answers.Res.TelerikEditor.Redo,exec:function(e){var ed=$(this).data("kendoEditor");ed.exec("redo")}},"bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull",{name:"formatting",items:[{text:Answers.Res.TelerikEditor.FormatH1,value:"p.contentHeader1"},{text:Answers.Res.TelerikEditor.FormatH2,value:"p.contentHeader2"},{text:Answers.Res.TelerikEditor.FormatStandard,value:"p.contentStandard"},{text:Answers.Res.TelerikEditor.FormatCodeBlock,value:"p.contentCodeblock"}],width:100},"insertUnorderedList","insertOrderedList","indent","outdent","createLink","unlink",insertImage,foreColor,"createTable","addRowAbove","addRowBelow","addColumnLeft","addColumnRight","deleteRow","deleteColumn"],messages:{bold:Answers.Res.TelerikEditor.Bold,italic:Answers.Res.TelerikEditor.Italic,underline:Answers.Res.TelerikEditor.Underline,strikethrough:Answers.Res.TelerikEditor.Strikethrough,superscript:Answers.Res.TelerikEditor.Superscript,subscript:Answers.Res.TelerikEditor.Subscript,justifyCenter:Answers.Res.TelerikEditor.JustifyCenter,justifyLeft:Answers.Res.TelerikEditor.JustifyLeft,justifyRight:Answers.Res.TelerikEditor.JustifyRight,justifyFull:Answers.Res.TelerikEditor.JustifyFull,insertUnorderedList:Answers.Res.TelerikEditor.InsertUnorderedList,insertOrderedList:Answers.Res.TelerikEditor.InsertOrderedList,indent:Answers.Res.TelerikEditor.Indent,outdent:Answers.Res.TelerikEditor.Outdent,createLink:Answers.Res.TelerikEditor.CreateLink,unlink:Answers.Res.TelerikEditor.Unlink,insertImage:Answers.Res.TelerikEditor.InsertImage,insertHtml:Answers.Res.TelerikEditor.InsertHtml,viewHtml:Answers.Res.TelerikEditor.ViewHtml,fontSize:Answers.Res.TelerikEditor.FontSize,formatBlock:Answers.Res.TelerikEditor.FormatBlock,formatting:Answers.Res.TelerikEditor.Formatting,foreColor:Answers.Res.TelerikEditor.ForeColor,backColor:Answers.Res.TelerikEditor.BackColor,style:Answers.Res.TelerikEditor.Style,uploadFile:Answers.Res.TelerikEditor.UploadFile,orderBy:Answers.Res.TelerikEditor.OrderBy,orderBySize:Answers.Res.TelerikEditor.OrderBySize,orderByName:Answers.Res.TelerikEditor.OrderByName,imageAltText:Answers.Res.TelerikEditor.ImageAltText,linkWebAddress:Answers.Res.TelerikEditor.LinkWebAddress,linkText:Answers.Res.TelerikEditor.LinkText,linkToolTip:Answers.Res.TelerikEditor.LinkToolTip,linkOpenInNewWindow:Answers.Res.TelerikEditor.LinkOpenInNewWindow,dialogUpdate:Answers.Res.TelerikEditor.DialogUpdate,dialogInsert:Answers.Res.TelerikEditor.DialogInsert,dialogButtonSeparator:Answers.Res.TelerikEditor.DialogButtonSeparator,dialogCancel:Answers.Res.TelerikEditor.DialogCancel,createTable:Answers.Res.TelerikEditor.CreateTable,addColumnLeft:Answers.Res.TelerikEditor.AddColumnLeft,addColumnRight:Answers.Res.TelerikEditor.AddColumnRight,addRowAbove:Answers.Res.TelerikEditor.AddRowAbove,addRowBelow:Answers.Res.TelerikEditor.AddRowBelow,deleteRow:Answers.Res.TelerikEditor.DeleteRow,deleteColumn:Answers.Res.TelerikEditor.DeleteColumn},execute:function(e){if(e.name==="createtable"){var that=this;setTimeout(function(){var table=$(that.body).children("table").last();if(!table.next().length)table.after("<br>")},1)}},paste:function(e){var that=this;setTimeout(function(){var table=$(that.body).children("table").last();if(table.length&&!table.next().length)table.after("<br>")},1);if(e&&e.html&&e.html.indexOf('<img src="data:image/')===0)e.html=""}});var editorContainer=$("#"+id).closest(".k-editor"),editorToolbar=editorContainer.find(".k-editor-toolbar");editorContainer.find(".k-tool-icon").each(function(){$(this).text($(this).attr("title"))});if(Answers.IsRtl)editorContainer.addClass("k-rtl");var thisEditor=$("#"+id).data("kendoEditor");$(thisEditor.window).focus(function(){$(editorContainer).addClass("inputHasFocus");if(onFocusCallback)onFocusCallback()});editorToolbar.getFocusable().focus(function(){if(onFocusCallback)onFocusCallback()});editorToolbar.getFocusable().first().on("keydown",function(e){if(e.keyCode===9&&!e.shiftKey){Answers.Editor.Focus(id);return false}return true});$(thisEditor.window).blur(function(){$(editorContainer).removeClass("inputHasFocus")});$(thisEditor.window).bind("mousedown",function(event){$(thisEditor.window.parent.window.document.body).trigger(event)});$(".k-dropdown").each(function(){var that=$(this);that.attr("title",that.find(".k-input").eq(0).text())});if(Answers.IsRtl)$(thisEditor.body).addClass("rtl");if(focusOnInit)editor.Focus(id);if($.browser.msie&&parseInt($.browser.version)<9&&!editor.IsCustomCssLoaded){$("link[href*='kendo.custom.css']").one("load",function(){var head=document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css";style.styleSheet.cssText=":before,:after{content:none !important;}";head.appendChild(style);setTimeout(function(){head.removeChild(style)},0)});setTimeout(function(){$("link[href*='kendo']").each(function(){var link=$(this);link.attr("href",link.attr("href"))})},10);editor.IsCustomCssLoaded=true}};editor.ShowImage=function(id){var thisEditor=$("#"+id).data("kendoEditor"),sessionId=$("#"+id).data("sessionId");if(sessionId){var win=thisEditor.window,url=Answers.Res.TelerikEditor.UploadImageUrl+"?uploadSessionId="+sessionId;Answers.Util.ShowDialog($("#InsertImageDlg"),{url:url,refresh:true,focusBack:win.document.body},null)}};editor.InsertImage=function(imageUrl,sessionId){var textarea=$("textarea[data-session-id='"+sessionId+"']"),thisEditor=$("#"+textarea[0].id).data("kendoEditor");thisEditor.exec("inserthtml",{value:"<img src='"+imageUrl+"' />"})},editor.Remove=function(id){var ed=$("#"+id).data("kendoEditor");if(ed){var textareaHtml=$("#"+id).clone().text(ed.value()).wrap("<p>").parent().html();ed.destroy();var editor=$("#"+id).closest(".k-editor"),nextTo=editor.prev();if(nextTo.length===0){nextTo=editor.parent();editor.remove();nextTo.append(textareaHtml)}else{editor.remove();nextTo.after(textareaHtml)}}};editor.Text=function(id){return $("<div />").html(editor.Content(id)).text()};editor.Content=function(id,content,encoded){if(content)return $("#"+id).data("kendoEditor").value(content);else{content=$.trim($("#"+id).data("kendoEditor").value());if(encoded)content=$("<div/>").text(content).html();return content}};editor.Focus=function(id){var kendoEditor=$("#"+id).data("kendoEditor"),lastChild=kendoEditor.body.lastChild,range=kendoEditor.createRange();if(kendoEditor.value()===""||!document.createRange){kendoEditor.focus();return}while(lastChild&&lastChild.nodeType!=1)if(lastChild.previousSibling)lastChild=lastChild.previousSibling;else break;if(!lastChild){kendoEditor.focus();return}range.selectNodeContents(lastChild);range.collapse(false);kendoEditor.saveSelection(range);kendoEditor.focus();kendo.ui.editor.Dom.scrollTo(lastChild)};editor.Bind=function(id,eventType,handler){if(!eventType||!handler)return;$($("#"+id).data("kendoEditor").body).bind(eventType,function(){handler()})};return editor}(Answers.Editor||{});Answers.DropNav={transition:false,menuKeys:{tab:9,escape:27,expand:39,previous:38,collapse:37,next:40},horizontalKeys:{previous:37,collapse:38,next:39,expand:40},rtlKeys:{expand:37,collapse:39},rtlHorizontalKeys:{previous:39,next:37},MovePrevious:function(){var selectedForum=$("#CurrentScope_ForumName").val(),selectedFilter=$("#CurrentScope_Filter").val(),selectedOption=$("a[data-forum='"+selectedForum+"'][data-filter='"+selectedFilter+"']");if(selectedOption){var previousOptionContainer=$(selectedOption[0].parentElement).prev();if(previousOptionContainer&&previousOptionContainer.hasClass("topNavLink"))previousOptionContainer=previousOptionContainer.prev();if(previousOptionContainer&&previousOptionContainer[0]){var previousOption=$(previousOptionContainer[0].firstChild);if(previousOption)Answers.DropNav.ChangeSelection(selectedOption,previousOption);previousOption.focus()}else{var lastOption=$("#dropNavSearch li:last")[0].firstChild;if(lastOption)Answers.DropNav.ChangeSelection(selectedOption,lastOption);lastOption.focus()}}},MoveNext:function(){var selectedForum=$("#CurrentScope_ForumName").val(),selectedFilter=$("#CurrentScope_Filter").val(),selectedOption=$("a[data-forum='"+selectedForum+"'][data-filter='"+selectedFilter+"']");if(selectedOption){var nextOptionContainer=$(selectedOption[0].parentElement).next();if(nextOptionContainer&&nextOptionContainer.hasClass("topNavLink"))nextOptionContainer=nextOptionContainer.next();if(nextOptionContainer&&nextOptionContainer[0]){var nextOption=$(nextOptionContainer[0].firstChild);if(nextOption)Answers.DropNav.ChangeSelection(selectedOption,nextOption);nextOption.focus()}else{var firstOption=$("#dropNavSearch li:first")[0].firstChild;if(firstOption)Answers.DropNav.ChangeSelection(selectedOption,firstOption);firstOption.focus()}}},ChangeSelection:function(currentSelection,newSelection){$("#CurrentScope_ForumName").val($(newSelection).data("forum"));$("#CurrentScope_Filter").val($(newSelection).data("filter"));currentSelection.removeClass("dropNavSelected");$(newSelection).addClass("dropNavSelected")},HandleSearchCommands:function(event){switch(event.which){case Answers.DropNav.menuKeys.next:Answers.DropNav.MoveNext();event.preventDefault();break;case Answers.DropNav.menuKeys.previous:Answers.DropNav.MovePrevious();event.preventDefault();break;case Answers.DropNav.menuKeys.collapse:$("#SearchTerm").focus();break;case Answers.DropNav.menuKeys.expand:$("#SearchTerm").focus();break;case Answers.DropNav.menuKeys.escape:$("#SearchTerm").focus();event.preventDefault();break;case Answers.DropNav.menuKeys.tab:if(!event.shiftKey)$("#SearchNavBtn").focus();else $("#communityLogoLink").focus();event.preventDefault();break}},StartNav:function(container,triggerShow){container=$(container);if(container.length==0)container=$("body");if($(".dropNav",container).length===0)if(container.hasClass("dropNav"))container=container.parent();else return;Answers.DropNav.ClearEvents(container);$("transition msTransition MozTransition webkitTransition".split(" ")).each(function(i,v){if($(".dropNav",container).get(0).style[v]!=undefined)Answers.DropNav.transition=true});$(".dropNav ul > li",container).find("a, button").attr("tabindex",-1);Answers.DropNav.SetPosition($(".dropNav ul",container).not(".dropNavColumn ul, .dropNavDelayShow ul, .dropNavNoNav ul"));Answers.DropNav.AddRoles($(".dropNav",container));$(".dropNav",container).not(".dropNavNoKeyAction").on("mouseup.dropNav, keypress.dropNav","a, button, input[type='image']",function(event){if($(this).parent().is(".dropNavDelayShow"))return;if(event.which===1||event.which===13||event.which===32)if($(this).siblings().eq(-1).is("ul"))Answers.DropNav.ShowNav($(this).parent());else Answers.DropNav.HideNav($(this).parents(".dropNav"))});$(".dropNav",container).not(".dropNavNoKeyAction").on("mouseup.dropNav, keydown.dropNav","a, button, input[type='image']",function(event){if($(this).parent().is(".dropNavDelayShow"))return;if(event.which!==1||event.which!==13||event.which!==32)return Answers.DropNav.KeyCommands(event)});$(".dropNav",container).not(".dropNavNoKeyAction").on("hover.dropNav","a, button",function(event){var f=$(":focus"),t=$(this),sameNav=f.parentsUntil(".dropNav").parent().is(t.parentsUntil(".dropNav").parent());setTimeout(function(){var h;try{h=t.is($(":hover").eq(-1))}catch(ex){h=!t.is($(".dropNavHover").eq(-1))}if(h){if(f!==t&&sameNav&&!f.is(".dropNavShow")&&(t.parent().parent().parent().is(".dropNavShow")||t.parent().parent().is(".dropNav")))t.focus();t.addClass("dropNavHover")}else t.removeClass("dropNavHover")},1)});$(".dropNav",container).not(".dropNavNoKeyAction").on("focus.dropNav","a, button",function(event){var h,t=$(this);try{h=$(":hover")}catch(ex){h=$(".dropNavHover")}var sameNav=h.parentsUntil(".dropNav").parent().is(t.parentsUntil(".dropNav").parent());if(h!==t&&sameNav)h.removeClass("dropNavHover")});$(".dropNavNoKeyAction > button",container).on("mouseup.dropNav, keydown.dropNav",function(event){var p=$(this).parent();if(!p.is(".dropNavDelayShow"))switch(event.which){case 1:case 13:case 32:case 40:return Answers.DropNav.ShowNav(p)}});$(".dropNav",container).on("mouseup.dropNav",function(event){if(!event.ctrlKey)event.stopPropagation()});$(".dropNav",container).on("dropNavDelayedShow",function(event){Answers.DropNav.DelayedShow(event)});$(".dropNavClose",container).on("click.dropNav",function(event){Answers.DropNav.HideNav(".dropNavShow")});$("body").on("mousedown.dropNav, keyup.dropNav",function(event){switch(event.which){case 1:if($(event.target).is(".dropNav")||$(event.target).parents(".dropNav").length>0)return false;else if($(event.target).is("#SearchTerm"))return true;else Answers.DropNav.HideNav(".dropNavShow");break;case 9:if(event.shiftKey&&$(event.target).is("#communityLogoLink")){Answers.DropNav.HideNav(".dropNavShow");$("#communityLogoLink").focus();return true}if($(event.target).is("#SearchTerm")||$(event.target).is("#SearchNavBtn")){event.preventDefault();return false}if(!$(event.target).is(".dropNav")&&$(event.target).parents(".dropNav").length===0){Answers.DropNav.HideNav(".dropNavShow");event.preventDefault();return false}if($(event.target).hasClass("forumSelect")){Answers.DropNav.HideNav(".dropNavShow");$("a:first","#TopNav").focus();event.preventDefault();return false}break;case 27:if($(event.target).is("#SearchTerm")||$(event.target).is("#SearchNavBtn")){$("#SearchTerm").focus();event.preventDefault();return false}Answers.DropNav.HideNav(".dropNavShow");$("#surveyDivBlock").hide()}});if($(triggerShow).length===1)Answers.DropNav.ShowNav($(triggerShow).parent())},AddRoles:function(container){var menu,menulabel;container=$(container);container.each(function(i,e){menu=$(e);menulabel=menu.attr("aria-label")==null?menu.children().eq(-1).is("ul")?$.trim(menu.children().eq(0).text())==""?menu.children().eq(0).attr("title")==null?"":$.trim(menu.children().eq(0).attr("title")):$.trim(menu.children().eq(0).text()):"":menu.attr("aria-label");menu.attr({"role":menu.attr("role")==null?"menu":menu.attr("role"),"aria-label":menulabel});$("li",menu).each(function(ii,ee){if(!$(ee).is(".heading")){$(ee).attr({"role":"presentation"});$(ee).find("button, a").eq(0).attr({"role":"menuitem","aria-label":$.trim($(ee).find("button, a").eq(0).text())});if($(ee).is(".dropNavDelayShow"))$(ee).attr({"aria-haspopup":"true","aria-expanded":"false"});else $(ee).attr({"aria-haspopup":"false"})}});$("ul",menu).each(function(ii,ee){var isColumnMenu=menu.children().eq(-1).is(".dropNavColumn");$(ee).attr({"role":"menu"});if(!isColumnMenu){$(ee).attr({"aria-hidden":"true"});var caller=$(ee).parent().find("button").eq(0);if(caller.length>0)$(ee).attr({"aria-labelledby":caller.attr("id")})}$(ee).parent().attr({"aria-haspopup":"true","aria-expanded":"false"})})})},ClearEvents:function(container){$(".dropNav button",container).off("mouseup.dropNav, keydown.dropNav, keypress.dropNav");$(".dropNav input[type='image']",container).off("mouseup.dropNav, keydown.dropNav, keypress.dropNav");$(".dropNav",container).off("hover.dropNav","a, button");$(".dropNav",container).off("focus.dropNav","a, button");$(".dropNav",container).off("keydown.dropNav","a, button");$(".dropNav",container).off("mouseup.dropNav");$(".dropNav",container).off("dropNavDelayedShow");$(".dropNavClose",container).off("click.dropNav");$("body").off("mousedown.dropNav, keyup.dropNav")},DelayedShow:function(event){var item=$(event.target);if(item.parent().hasClass("dropNavDelayShow")){item.parent().removeClass("dropNavDelayShow");Answers.DropNav.SetPosition(item.parent().find("ul"));Answers.DropNav.ShowNav($(item).parent())}},SetPosition:function(item){$(item).each(function(){var item=$(this),h=parseInt(item.css("max-height"),10);if(isNaN(h)&&!isFinite(h)||h===0){h=0;item.children().each(function(i,v){h+=$(v).outerHeight()})}item.attr("data-dropnavheight",h).addClass("dropNavTransitionOff");if(!item.hasClass("dropNavColumn"))item.children().eq(0).css("margin-top",h*-1+"px")})},NavPosition:function(item){var vis=item.parent().hasClass("dropNavShow"),dropheight=parseInt(item.attr("data-dropnavheight"),10),pos=vis?0:dropheight,height=vis?dropheight:0;if(item[0].id!="dropNavSearch")Answers.DropNav.TransitionEnd(item);item.css("height",height+"px");if(!item.hasClass("dropNavColumn"))item.children().eq(0).css("margin-top",pos*-1+"px")},ShowNav:function(item,shouldToggleOnTransition){if(shouldToggleOnTransition==undefined)shouldToggleOnTransition=true;if(item.hasClass("dropNavShow")&&item.selector!=="#SearchScoping")Answers.DropNav.HideNav(item);else{var selectedForum=$("#CurrentScope_ForumName").val(),selectedFilter=$("#CurrentScope_Filter").val(),selectedOption=$("a[data-forum='"+selectedForum+"'][data-filter='"+selectedFilter+"']");if(selectedOption)selectedOption.addClass("dropNavSelected");if(item.hasClass("dropNavShow")&&!shouldToggleOnTransition)return false;var ul=item.children().eq(-1);if(ul.is("ul")){Answers.DropNav.HideNav($(".dropNavShow").not(item.parents(".dropNav").add(item.parentsUntil(".dropNav"))));item.addClass("dropNavShow").attr("aria-expanded","true").find("a, button").removeAttr("tabindex");ul.attr("aria-hidden","false");item.trigger("dropNavVisible");setTimeout(function(){Answers.DropNav.NavPosition(ul)},1);return false}}return true},HideNav:function(item,setFocusOnItem){var ul;if(setFocusOnItem===undefined)setFocusOnItem=true;item=$(item).eq(0);if(item.length>0){item.removeClass("dropNavShow").find(".dropNavShow").removeClass("dropNavShow").each(function(){var t=$(this);setTimeout(function(){Answers.DropNav.NavPosition(t.children().eq(-1))},1)});item.trigger("dropNavHidden");ul=item.children().eq(-1);if(ul.is("ul")){item.attr("aria-expanded","false").find(".dropNavShow").attr("aria-expanded","false");ul.attr("aria-hidden","true").find("a, button").attr("tabindex",-1);setTimeout(function(){Answers.DropNav.NavPosition(ul)},1);if(setFocusOnItem)ul.parent().find("a, select, input, button").eq(0).focus()}}},TransitionEnd:function(item){var topNav=item.parents(".dropNav").eq(-1),shown=item.parent().hasClass("dropNavShow");if(shown)topNav.trigger("dropNavChange",{isvisible:topNav.is(".dropNavShow")||topNav.find(".dropNavShow").length>0});var toggle=function(){var defaultFocusedMenuItem;if(shown){item.addClass("dropNavTransitionOn").removeClass("dropNavTransitionOff");if(item.parent().hasClass("dropNavShow")){defaultFocusedMenuItem=item.find("a:hover, button:hover").not("button[disabled]").eq(0);if(!defaultFocusedMenuItem||defaultFocusedMenuItem.length===0)defaultFocusedMenuItem=item.find("a, button").not("button[disabled]").eq(0);defaultFocusedMenuItem.focus()}}else{item.addClass("dropNavTransitionOff").removeClass("dropNavTransitionOn");topNav.trigger("dropNavChange",{isvisible:topNav.is(".dropNavShow")||topNav.find(".dropNavShow").length>0})}};if(Answers.DropNav.transition){var f=function(event){if(event.eventPhase===2){toggle();item.off(".dropNavTransition");event.stopPropagation()}};item.on({"transitionend.dropNavTransition":f,"MSTransitionEnd.dropNavTransition":f,"webkitTransitionEnd.dropNavTransition":f})}else toggle()},KeyCommands:function(event){var item=$(event.target).parent(),itemto=null,items=null,isTabbable=false,itemindex=item.index(),listindex=item.siblings().add(item).index(),isbutton=$(event.target).is("button, input[type='image']"),key=event.which,isHorizontal=item.css("display").toLowerCase()!=="block",keys=$.extend({},Answers.DropNav.menuKeys,isHorizontal?Answers.DropNav.horizontalKeys:{},Answers.IsRtl?isHorizontal?Answers.DropNav.rtlHorizontalKeys:Answers.DropNav.rtlKeys:{});if(item.closest(".dropNavColumn").length>0)return Answers.DropNav.HandleColumns(event);if((key===keys.tab||key===keys.previous||key===keys.next)&&isbutton)Answers.DropNav.HideNav(item);if(item.parents("#SearchForm").length>0){Answers.DropNav.HandleSearchCommands(event);return true}switch(key){case (itemindex===0||itemindex===listindex||item.is(".dropNavDelayShow"))&&(item.hasClass("dropNav")||item.parent().hasClass("dropNav")||item.parent().parent().hasClass("dropNav"))&&keys.tab:return true;case !event.shiftKey&&keys.tab:case keys.next:items=item.parent().children();isTabbable=items.eq(itemindex-listindex).hasClass("tabsStop");itemto=isTabbable?items.eq(itemindex-listindex).find("a, button, input[type='image']").not(":disabled").eq(0):items.eq(itemindex-listindex).children().eq(0);while(!itemto.is("a, button, input[type='image']")||itemto.hasClass("disabled")){itemindex=itemindex+1;if(itemindex>=listindex)return true;itemto=items.eq(itemindex-listindex).children().eq(0)}itemto.focus();break;case event.shiftKey&&keys.tab:case keys.previous:items=item.parent().children();isTabbable=items.eq(itemindex).hasClass("tabsStop");itemto=isTabbable?items.eq(itemindex).find("a, button, input[type='image']").not(":disabled").eq(0):(itemto=items.eq(--itemindex).children().eq(0));while(!itemto.is("a, button, input[type='image']")||itemto.hasClass("disabled")){itemindex=itemindex-1;if(itemindex<0)return true;itemto=items.eq(itemindex).children().eq(0)}itemto.focus();break;case keys.expand:if(isbutton&&item.children().eq(-1).is("ul"))Answers.DropNav.ShowNav(item);else{itemto=item.parents(".dropNavShow").eq(-1);Answers.DropNav.HideNav(itemto);items=itemto.siblings().add(itemto);itemindex=items.index(itemto);var next=items.eq(itemindex-items.index()).children().eq(0);while((!next.is("a, button, input[type='image']")||next.hasClass("disabled"))&&next.parent().is(items.parent()))next=items.eq(++itemindex-items.index()).children().eq(0);next.focus()}break;case keys.collapse:itemto=item.parents(".dropNavShow").eq(0);Answers.DropNav.HideNav(itemto);items=itemto.siblings().add(itemto);itemindex=items.index(itemto);var prev=items.eq(itemindex-(itemto.parent().hasClass("dropNav")?1:0)).children().eq(0);while((!prev.is("a, button, input[type='image']")||prev.hasClass("disabled"))&&prev.parent().is(items.parent()))prev=items.eq(--itemindex-(itemto.parent().hasClass("dropNav")?1:0)).children().eq(0);prev.focus();break;case keys.escape:item.parentsUntil(".dropNav").eq(-1).children().eq(0).focus();Answers.DropNav.HideNav(".dropNavShow");break;default:return true}event.preventDefault()},HandleColumns:function(event){var item=$(event.target).parent(),itemindex=item.index(),listindex=item.siblings().add(item).index(),cols=item.parent().siblings().add(item.parent()),colindex=item.parent().index(),keys=$.extend({},Answers.DropNav.menuKeys,Answers.IsRtl?Answers.DropNav.rtlKeys:{});switch(event.which){case (itemindex===0&&colindex===0||itemindex===listindex&&colindex===cols.index())&&keys.tab:return true;case !event.shiftKey&&keys.tab:case keys.next:itemindex-listindex<0||colindex++;cols.eq(--colindex-cols.index()).children().eq(itemindex-listindex).children().eq(0).focus();break;case event.shiftKey&&keys.tab:case keys.previous:--itemindex>=0||--colindex;cols.eq(colindex).children().eq(itemindex).children().eq(0).focus();break;case keys.expand:cols=cols.eq(colindex-cols.index()).children();cols.eq(cols.index(cols.get(itemindex))).children().eq(0).focus();break;case keys.collapse:cols.eq(--colindex).children().eq(cols.index(cols.get(itemindex))).children().eq(0).focus();break;case keys.escape:item.parentsUntil(".dropNav").eq(-1).children().eq(0).focus();Answers.DropNav.HideNav(".dropNavShow");break;default:return true}event.preventDefault()}};$(document).ready(function(){$(document).ajaxError(function(event,xhr,ajaxOptions){Answers.Util.HandleReadOnlyResponse(xhr.responseText)});$.ajaxPrefilter(function(options,originalOptions,jqXHR){var responsive;if(window.location.search&&window.location.search.length>1){responsive=window.location.search.toLowerCase().match(/responsive=(true|false)/g);if(responsive&&responsive.length>0)options.url=options.url+(options.url.indexOf("?")>0?"&":"?")+responsive[0]}});Answers.Util.DisableReadOnlyClick();Answers.Util.InitiateDialogs();Answers.Util.SetTimeZoneOffset();Answers.DropNav.StartNav();Answers.Announcement.Initilize();if($("#SearchBox").length>0)if($("#SearchBox").data("autosuggest")===true)Answers.SearchWithAutoSuggest.Initialize();else Answers.Search();if(Answers.Res.TelerikEditor.Editor==="telerik")$(".RichText").each(function(){$(this).siblings(".editorLoading").hide();Answers.Editor.Create($(this)[0].id,null,false)});else $(".RichText").each(function(){$(this).siblings(".editorLoading").hide();$(".RichText").each(function(){window.rte.create($(this))})});$("a.signIn").attr("href",$("#siteSignIn").attr("href"));$("img:not([alt])").attr("alt",Answers.Res.Common.DefaultAltText);$("#noThreadsSearch").click(function(){$("#SearchTerm").focus()});$("#LocalePopup > .dropNav").on("dropNavChange",function(event,param){$("body").toggleClass("footerTop",param.isvisible)});if(typeof pageLoad!="undefined")pageLoad();$("#goToPageNum").on({"input":function(e){$(this).blur().focus()},"keyup":function(e){if(e.which!==13)Answers.Util.ValidatePageOnlyNumbers(this)},"keypress":function(e){if(e.keyCode===13){if($(this).parents().hasClass("pagerContainer"))return;Answers.Util.ValidatePageOnlyNumbers(this);var newPage=Answers.Util.ValidatePageValue(e,this.value,$("#currentPage").val(),$("#currentMaxPage").val());if(newPage>0)Answers.Util.ReloadPage($("#goToPageLink").attr("href").replace("~pagenum~",newPage));return false}}});if($("#PrivacyBanner").length>0){if(Answers.Util.GetCookie(Answers.Res.EPrivacy.CookieName,null))$("#PrivacyBanner").hide();$("#PrivacyBanner_Close").on("click",function(e){$("#PrivacyBanner").hide();Answers.Util.SetCookieWithExpiration(Answers.Res.EPrivacy.CookieName,"1",null,Answers.Res.EPrivacy.CookieExpires,"microsoft.com");e.preventDefault()})}Answers.Auth.CheckNextAction();if($("#privatemessagecountlink").length>0)$.ajax(Answers.Res.MessagesCountUrl,{cache:false,success:function(data,status,jqXhr){if(data&&data.length>0)$("#privatemessagecountlink").html(data)}})})